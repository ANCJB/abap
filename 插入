DATA:WA_CLASS LIKE ZCLASS.
DATA:IT_CLASS LIKE STANDARD TABLE OF WA_CLASS.

TYPES: BEGIN OF TY_TEST,
  ZCLASS   TYPE ZCLASS-ZCLASS,
  ZNAME    TYPE ZCLASS-ZNAME,
  NUMBER   TYPE ZREPORT-ZNUM,
  MATH     TYPE ZREPORT-ZMATH,
  JAPANESE TYPE ZREPORT-ZJAPANESE,

END OF TY_TEST.
*
DATA WA_TEST TYPE TY_TEST.
DATA IT_TEST LIKE STANDARD TABLE OF  WA_TEST.

*クラス：Aの生徒の成績データを抽出
SELECT
  T1~ZCLASS                  "クラス
  T1~ZNAME                   "名前
  T2~ZNUM AS NUMBER          "番号
  T2~ZMATH AS MATH           "数学
  T2~ZJAPANESE AS JAPANESE   "日本語

      FROM ZCLASS  AS T1
INNER JOIN ZREPORT AS T2
        ON T1~ZCLASS = T2~ZCLASS AND T1~ZNAME = T2~ZNAME
INTO TABLE IT_TEST
     WHERE T1~ZCLASS = 'A'.
**成績を出力
LOOP AT IT_TEST INTO WA_TEST.
  WRITE: / WA_TEST-ZCLASS,
           WA_TEST-NUMBER,
           WA_TEST-ZNAME,
           WA_TEST-MATH,
           WA_TEST-JAPANESE.

ENDLOOP.


*項目を指定して更新する
*UPDATE ZCLASS SET ZAGE = 80 WHERE ZNAME = '渡辺'.
*CHECK SY-SUBRC = 0.
*WRITE: / '更新成功'.
*WRITE:WA_CLASS.

  SELECT SINGLE *
*    ZCLASS       "クラス"名前
*    ZNAME        "番号
*    ZAGE         "年齢
*    ZCITY        "都市
  FROM ZCLASS
  INTO WA_CLASS
  WHERE ZCLASS = 'A' AND ZNAME = '渡辺'.


*更新UPETAE
*ワークエリアによって更新する
WA_CLASS-ZAGE = 50.
WA_CLASS-ZCITY = '静岡'.

*UPDATE ZCLASS FROM WA_CLASS.
*CHECK SY-SUBRC = 0.
*WRITE:/ '更新成功'.
*WRITE:WA_CLASS.
*
*UPDATE ZCLASS SET ZCITY = 'BEIJING' WHERE ZNAME = '王'.
* IF SY-SUBRC = 0 .
*   COMMIT WORK.
*   WRITE: / '更新成功'.
*   WRITE:WA_CLASS.
* ELSE.
*   ROLLBACK WORK.
*   WRITE: / '更新失敗'.
* ENDIF.



*
*挿入INSERT

*一行のデータを挿入する
*WA_CLASS-ZNAME = '田中'.
*INSERT ZCLASS FROM WA_CLASS.
*CHECK SY-SUBRC = 0.
*WRITE: / '挿入成功'.
*WRITE:WA_CLASS.
*
**複数行のデータを挿入する
*    WA_CLASS-ZNAME  =  'LILI'.   "番号
*APPEND WA_CLASS TO IT_CLASS.
*    WA_CLASS-ZNAME  =  '李'.   "番号
*APPEND WA_CLASS TO IT_CLASS.
*    WA_CLASS-ZCLASS = 'B'.      "クラス"名前
*    WA_CLASS-ZNAME  =  '渡辺'.   "番号
* APPEND WA_CLASS TO IT_CLASS.
*
*
*   INSERT ZCLASS FROM TABLE IT_CLASS.
* IF SY-SUBRC = 0 .
*   WRITE: / '挿入成功'.
*   WRITE:WA_CLASS.
* ENDIF.
*
*
** 削除DELETE
*
* DELETE FROM ZCLASS WHERE ZCLASS = 'A' AND ZNAME = '渡辺'.
*
* DELETE ZCLASS FROM TABLE IT_CLASS.
*
** 基本的に禁止
*  DELETE FROM ZCLASS.


*  ＤBを編集MODFIY
  WA_CLASS-ZNAME = '鈴木'.

  UPDATE ZCLASS FROM WA_CLASS.
 IF SY-SUBRC = 0 .
   COMMIT WORK.
   WRITE: / '更新成功'.
   WRITE:WA_CLASS.
 ELSE.
   ROLLBACK WORK.
   WRITE: / '更新失敗'.
 ENDIF.

  MODIFY ZCLASS FROM  WA_CLASS.
 IF SY-SUBRC = 0 .
   WRITE: / '編集成功'.
 ELSE.
   WRITE: / '編集失敗'.
 ENDIF.


  MODIFY ZCLASS FROM TABLE IT_CLASS.
   IF SY-SUBRC = 0 .
   WRITE: / '編集成功'.
 ELSE.
   WRITE: / '編集失敗'.
 ENDI
